<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>üèì PONG PUCK - Game 56</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        * { margin: 0; padding: 0; }
        body { background: #000; font-family: Arial, sans-serif; color: #fff; overflow: hidden; }
        #gameCanvas { display: block; margin: 0 auto; background: #111; }
        #hud { position: absolute; top: 20px; left: 0; right: 0; display: flex; justify-content: center; gap: 100px; font-size: 64px; z-index: 10; }
    </style>
</head>
<body>
    <div id="hud">
        <div>YOU: <span id="playerScore">0</span></div>
        <div>AI: <span id="aiScore">0</span></div>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const PUCK_ID = {{ puck_id }};
        const socket = io();
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let gameState = null;

        socket.on('connect', () => {
            socket.emit('join_game_room', { puck_id: PUCK_ID });
            socket.emit('request_game_state', { puck_id: PUCK_ID });
        });

        socket.on('game_state_update', (state) => {
            gameState = state;
            document.getElementById('playerScore').textContent = state.player_score;
            document.getElementById('aiScore').textContent = state.ai_score;
        });

        function render() {
            if (!gameState) return;

            ctx.fillStyle = '#111';
            ctx.fillRect(0, 0, 800, 600);

            // Center line
            ctx.strokeStyle = '#444';
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(400, 0);
            ctx.lineTo(400, 600);
            ctx.stroke();
            ctx.setLineDash([]);

            // Player paddle
            const playerY = (gameState.paddle_y / 100) * 600;
            ctx.fillStyle = '#0f0';
            ctx.fillRect(30, playerY - 50, 15, 100);

            // AI paddle
            const aiY = (gameState.ai_paddle_y / 100) * 600;
            ctx.fillStyle = '#f00';
            ctx.fillRect(755, aiY - 50, 15, 100);

            // Ball
            const ballX = (gameState.ball_x / 100) * 800;
            const ballY = (gameState.ball_y / 100) * 600;
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 10, 0, Math.PI * 2);
            ctx.fill();

            requestAnimationFrame(render);
        }

        render();
    </script>
</body>
</html>
